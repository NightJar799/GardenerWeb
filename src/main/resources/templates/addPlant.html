<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${plant.name ?: 'Plant Details'}">Plant Details</title>
</head>
<body>

<div style="margin-bottom: 20px;">
    <a th:href="@{/main}">Back to Plant List</a>
</div>


<div style="margin-bottom: 20px; text-align: center;">
    <img th:src="@{/images/__${plant.plantId}__.jpg}"
         alt="Plant Image"
         style="max-width: 400px; max-height: 400px; border: 1px solid #ccc;"
         onerror="this.onerror=null; this.src='/images/default-plant.jpg';">
    <p th:if="${plant.plantId}" style="color: #666; font-style: italic;">
        Image ID: <span th:text="${plant.plantId + '.jpg'}"></span>
    </p>
</div>


<div th:unless="${session.user != null and session.user.authorities.?[authority == 'ROLE_ADMIN'].size() > 0}">
    <h1 th:text="${plant.name}">Plant Name</h1>
    <h3 style="color: #2e7d32; font-style: italic;" th:text="${plant.scienceName}">Scientific Name</h3>


    <div th:if="${session.user}" style="margin: 20px 0;">
        <form th:action="@{/favorite/add}" method="post" style="display: inline;">
            <input type="hidden" name="plantId" th:value="${plant.plantId}">
            <input type="hidden" name="userId" th:value="${session.user.id}">
            <button type="submit"
                    style="padding: 8px 16px; background-color: #e91e63; color: white; border: none; cursor: pointer; border-radius: 4px;">
                <3 Add to Favorites
            </button>
        </form>
        <span th:if="${isFavorite}" style="color: #e91e63; margin-left: 10px;">
                ★ This plant is in your favorites
            </span>
    </div>

    <h2>Plant Characteristics</h2>
    <table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse; width: 100%; margin-bottom: 20px;">
        <tr>
            <th style="width: 200px; background-color: #f5f5f5;">Characteristic</th>
            <th>Value</th>
        </tr>
        <tr th:if="${plant.plantId}">
            <td><strong>Plant ID:</strong></td>
            <td th:text="${plant.plantId}">ID</td>
        </tr>
        <tr th:if="${plant.name}">
            <td><strong>Common Name:</strong></td>
            <td th:text="${plant.name}">Name</td>
        </tr>
        <tr th:if="${plant.scienceName}">
            <td><strong>Scientific Name:</strong></td>
            <td th:text="${plant.scienceName}">Scientific Name</td>
        </tr>
        <tr th:if="${plant.description}">
            <td><strong>Description:</strong></td>
            <td th:text="${plant.description}">Description</td>
        </tr>
    </table>

    <h2>Growth Characteristics</h2>
    <table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse; width: 100%; margin-bottom: 20px;">
        <tr>
            <td><strong>Leaf Type:</strong></td>
            <td th:text="${plant.leafType}">Leaf Type</td>
            <td><strong>Root Type:</strong></td>
            <td th:text="${plant.root}">Root Type</td>
        </tr>
        <tr>
            <td><strong>Fruit Type:</strong></td>
            <td th:text="${plant.fruit}">Fruit Type</td>
            <td><strong>Annual/Perennial Fruit:</strong></td>
            <td th:text="${plant.ammFruit}">Annual/Perennial</td>
        </tr>
        <tr>
            <td><strong>Morphology:</strong></td>
            <td th:text="${plant.morphology}">Morphology</td>
            <td><strong>Growth Speed:</strong></td>
            <td th:text="${plant.growthSpeed}">Growth Speed</td>
        </tr>
        <tr>
            <td><strong>Survivability:</strong></td>
            <td th:text="${plant.survivability}">Survivability</td>
            <td><strong>Required Space (m²):</strong></td>
            <td th:text="${plant.space}">Space</td>
        </tr>
    </table>

    <h2>Environmental Requirements</h2>
    <table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse; width: 100%; margin-bottom: 20px;">
        <tr>
            <td><strong>Climate:</strong></td>
            <td th:text="${plant.climate}">Climate</td>
            <td><strong>Soil Type:</strong></td>
            <td th:text="${plant.soil}">Soil</td>
        </tr>
        <tr>
            <td><strong>Water Source:</strong></td>
            <td th:text="${plant.water}">Water</td>
            <td><strong>Landscape:</strong></td>
            <td th:text="${plant.landScape}">Landscape</td>
        </tr>
        <tr>
            <td><strong>PPFD (Light):</strong></td>
            <td th:text="${plant.ppfd}">PPFD</td>
            <td><strong>Humidity (%):</strong></td>
            <td th:text="${plant.humidity}">Humidity</td>
        </tr>
        <tr>
            <td><strong>pH Level:</strong></td>
            <td th:text="${plant.ph}">pH</td>
        </tr>
    </table>
</div>


<div th:if="${session.user != null and session.user.authorities.?[authority == 'ROLE_ADMIN'].size() > 0}">
    <h1>Edit Plant: <span th:text="${plant.name}"></span></h1>

    <form th:action="@{addPlant}" method="post" th:object="${plant}">
        <h2>Basic Information</h2>
        <table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse; width: 100%; margin-bottom: 20px;">
            <tr>
                <td><label for="name"><strong>Common Name:</strong></label></td>
                <td>
                    <input type="text" id="name" name="name" th:value="${plant.name}"
                           style="width: 100%; padding: 5px;" required>
                </td>
            </tr>
            <tr>
                <td><label for="scienceName"><strong>Scientific Name:</strong></label></td>
                <td>
                    <input type="text" id="scienceName" name="scienceName"
                           th:value="${plant.scienceName}" style="width: 100%; padding: 5px;">
                </td>
            </tr>
            <tr>
                <td><label for="description"><strong>Description:</strong></label></td>
                <td>
                        <textarea id="description" name="description"
                                  style="width: 100%; padding: 5px; min-height: 80px;"
                                  th:text="${plant.description}"></textarea>
                </td>
            </tr>
        </table>

        <h2>Growth Characteristics</h2>
        <table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse; width: 100%; margin-bottom: 20px;">
            <tr>
                <td><label for="leafType"><strong>Leaf Type:</strong></label></td>
                <td>
                    <input type="text" id="leafType" name="leafType" th:value="${plant.leafType}"
                           style="width: 100%; padding: 5px;">
                </td>
                <td><label for="root"><strong>Root Type:</strong></label></td>
                <td>
                    <input type="text" id="root" name="root" th:value="${plant.root}"
                           style="width: 100%; padding: 5px;">
                </td>
            </tr>
            <tr>
                <td><label for="fruit"><strong>Fruit Type:</strong></label></td>
                <td>
                    <input type="text" id="fruit" name="fruit" th:value="${plant.fruit}"
                           style="width: 100%; padding: 5px;">
                </td>
                <td><label for="ammFruit"><strong>Annual/Perennial:</strong></label></td>
                <td>
                    <select id="ammFruit" name="ammFruit" style="width: 100%; padding: 5px;">
                        <option value="">Select</option>
                        <option value="Y" th:selected="${plant.ammFruit == 'Y'}">Annual</option>
                        <option value="N" th:selected="${plant.ammFruit == 'N'}">Perennial</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td><label for="morphology"><strong>Morphology:</strong></label></td>
                <td>
                    <input type="text" id="morphology" name="morphology" th:value="${plant.morphology}"
                           style="width: 100%; padding: 5px;">
                </td>
                <td><label for="growthSpeed"><strong>Growth Speed:</strong></label></td>
                <td>
                    <select id="growthSpeed" name="growthSpeed" style="width: 100%; padding: 5px;">
                        <option value="">Select</option>
                        <option value="Slow" th:selected="${plant.growthSpeed == 'Slow'}">Slow</option>
                        <option value="Mid" th:selected="${plant.growthSpeed == 'Mid'}">Medium</option>
                        <option value="Fast" th:selected="${plant.growthSpeed == 'Fast'}">Fast</option>
                        <option value="VFast" th:selected="${plant.growthSpeed == 'VFast'}">Very Fast</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td><label for="survivability"><strong>Survivability:</strong></label></td>
                <td>
                    <select id="survivability" name="survivability" style="width: 100%; padding: 5px;">
                        <option value="">Select</option>
                        <option value="Low" th:selected="${plant.survivability == 'Low'}">Low</option>
                        <option value="Mid" th:selected="${plant.survivability == 'Mid'}">Medium</option>
                        <option value="High" th:selected="${plant.survivability == 'High'}">High</option>
                        <option value="Very High" th:selected="${plant.survivability == 'Very High'}">Very High</option>
                    </select>
                </td>
                <td><label for="space"><strong>Required Space (m²):</strong></label></td>
                <td>
                    <select id="space" name="space" style="width: 100%; padding: 5px;">
                        <option th:each="option : ${T(com.example.gardener.DTO.TestDTO).getSpaceOptions()}"
                                th:value="${option}"
                                th:text="${option}"
                                th:selected="${plant.space == option}">
                        </option>
                    </select>
                </td>
            </tr>
        </table>

        <h2>Environmental Requirements</h2>
        <table border="1" cellpadding="10" cellspacing="0" style="border-collapse: collapse; width: 100%; margin-bottom: 20px;">
            <tr>
                <td><label for="climate"><strong>Climate:</strong></label></td>
                <td>
                    <select id="climate" name="climate" style="width: 100%; padding: 5px;">
                        <option th:each="option : ${T(com.example.gardener.DTO.TestDTO).getClimateOptions()}"
                                th:value="${option}"
                                th:text="${option}"
                                th:selected="${plant.climate == option}">
                        </option>
                    </select>
                </td>
                <td><label for="soil"><strong>Soil Type:</strong></label></td>
                <td>
                    <select id="soil" name="soil" style="width: 100%; padding: 5px;">
                        <option th:each="option : ${T(com.example.gardener.DTO.TestDTO).getSoilOptions()}"
                                th:value="${option}"
                                th:text="${option}"
                                th:selected="${plant.soil == option}">
                        </option>
                    </select>
                </td>
            </tr>
            <tr>
                <td><label for="water"><strong>Water Source:</strong></label></td>
                <td>
                    <select id="water" name="water" style="width: 100%; padding: 5px;">
                        <option th:each="option : ${T(com.example.gardener.DTO.TestDTO).getWaterOptions()}"
                                th:value="${option}"
                                th:text="${option}"
                                th:selected="${plant.water == option}">
                        </option>
                    </select>
                </td>
                <td><label for="landScape"><strong>Landscape:</strong></label></td>
                <td>
                    <select id="landScape" name="landScape" style="width: 100%; padding: 5px;">
                        <option th:each="option : ${T(com.example.gardener.DTO.TestDTO).getLandscapeOptions()}"
                                th:value="${option}"
                                th:text="${option}"
                                th:selected="${plant.landScape == option}">
                        </option>
                    </select>
                </td>
            </tr>
            <tr>
                <td><label for="ppfd"><strong>PPFD (Light):</strong></label></td>
                <td>
                    <input type="text" id="ppfd" name="ppfd" th:value="${plant.ppfd}"
                           style="width: 100%; padding: 5px;" placeholder="e.g., 200-400 μmol/m²/s">
                </td>
                <td><label for="humidity"><strong>Humidity (%):</strong></label></td>
                <td>
                    <input type="number" id="humidity" name="humidity" th:value="${plant.humidity}"
                           step="0.1" style="width: 100%; padding: 5px;" min="0" max="100">
                </td>
            </tr>
            <tr>
                <td><label for="ph"><strong>pH Level:</strong></label></td>
                <td colspan="3">
                    <input type="number" id="ph" name="ph" th:value="${plant.ph}"
                           step="0.1" style="width: 100%; padding: 5px;" min="0" max="14">
                </td>
            </tr>
        </table>


        <p th:if="${errorAdd != null}" style="color: red">
            All fields must be entered!
        </p>

        <div style="margin-top: 20px; text-align: center;">
            <button type="submit" style="padding: 12px 24px; background-color: #4CAF50; color: white; border: none; cursor: pointer; font-size: 16px; border-radius: 4px;">
                add new Changes
            </button>
            <a th:href="@{/plant/{id}(id=${plant.plantId})}"
               style="padding: 12px 24px; background-color: #f44336; color: white; text-decoration: none; margin-left: 10px; display: inline-block; border-radius: 4px;">
                Cancel
            </a>
        </div>
    </form>
</div>


<div th:if="${session.user != null and session.user.authorities.?[authority == 'ROLE_ADMIN'].size() > 0}"
     style="position: fixed; top: 10px; right: 10px; background-color: #ff9800; color: white; padding: 5px 10px; border-radius: 3px; font-weight: bold;">
    ADMIN MODE
</div>
</body>
</html>